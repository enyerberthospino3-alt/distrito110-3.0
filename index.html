<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distrito 110</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="loginScreen" class="login-screen">
        <form id="loginForm" onsubmit="login(event)">
            <h2>Iniciar SesiÃ³n</h2>
            <input type="email" id="loginEmail" placeholder="Correo" required>
            <input type="password" id="loginPassword" placeholder="ContraseÃ±a" required>
            <button type="submit" id="loginBtn">Iniciar SesiÃ³n</button>
            <div id="loginError" class="error-msg"></div>
        </form>
    </div>

    <div id="mainApp" class="hidden">
        <header>
            <h1>Distrito 110</h1>
            <div class="cart-icon" onclick="toggleCart()">
                ðŸ›’ <span id="cartCount">0</span>
            </div>
            <button id="logoutBtn" onclick="logout()" class="hidden">Cerrar SesiÃ³n</button>
        </header>

        <nav class="categories">
            <button class="category-btn active" onclick="filterCategory('todos')">Todos</button>
            <button class="category-btn" onclick="filterCategory('ropa')">Ropa</button>
            <button class="category-btn" onclick="filterCategory('calzado')">Calzado</button>
        </nav>

        <main>
            <div id="productsGrid" class="products-grid"></div>
        </main>
    </div>

    <!-- Modal Carrito -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <h2>Carrito</h2>
            <div id="cartItems"></div>
            <div class="cart-summary">
                <strong>Total:</strong> <span id="cartTotal">0</span>
            </div>
            <button id="showCheckoutBtn" onclick="showCheckoutForm()">Proceder al Pago</button>
            <form id="checkoutForm" style="display:none;">
                <input type="text" id="customerName" placeholder="Nombre" required>
                <input type="tel" id="customerPhone" placeholder="TelÃ©fono" required>
                <input type="text" id="customerCity" placeholder="Ciudad" required>
                <input type="text" id="customerAddress" placeholder="DirecciÃ³n" required>
                <div class="payment-methods">
                    <div class="payment-method" onclick="selectPayment('Contraentrega')">Contraentrega</div>
                    <div class="payment-method" onclick="selectPayment('Transferencia')">Transferencia</div>
                </div>
                <button type="button" id="checkoutBtn" onclick="processCheckout()" disabled>Finalizar Pedido</button>
            </form>
        </div>
    </div>

    <!-- AquÃ­ continÃºa tu HTML de productos, admin y modales (idÃ©ntico al original) -->

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, Timestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBCxsB21i2-g9c6zIY988R8Xvq5ctVLzrI",
            authDomain: "distrito110-f80c4.firebaseapp.com",
            projectId: "distrito110-f80c4",
            storageBucket: "distrito110-f80c4.firebasestorage.app",
            messagingSenderId: "433906086147",
            appId: "1:433906086147:web:b1595ae6759d2499073936"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let products = [];
        let orders = [];
        let cart = JSON.parse(localStorage.getItem('distrito110_cart')) || [];
        let selectedPayment = null;
        let editingProductId = null;
        let currentImageData = null;
        let currentFilter = 'todos';

        // ... aquÃ­ siguen TODAS tus funciones: login, logout, loadProducts, loadOrders, updateCart, etc.
        // ðŸ‘† No te las repito porque ya las tenÃ­as bien, solo eliminÃ© los duplicados de renderProducts

        // âœ… VersiÃ³n Ãºnica y final de renderProducts:
        function renderProducts(filter = 'todos') {
            currentFilter = filter;
            const grid = document.getElementById('productsGrid');
            
            if (products.length === 0) {
                grid.innerHTML = '<div class="empty-products">No hay productos disponibles</div>';
                return;
            }

            const filteredProducts = filter === 'todos' ? products : products.filter(p => p.category === filter);

            if (filteredProducts.length === 0) {
                grid.innerHTML = '<div class="empty-products">No hay productos en esta categorÃ­a</div>';
                return;
            }

            grid.innerHTML = filteredProducts.map(product => `
                <div class="product-card" onclick="openProductDetail('${product.id}')">
                    <div class="product-image">
                        ${product.image ? `<img src="${product.image}" alt="${product.name}">` : '<div style="font-size: 4rem;">ðŸ“¦</div>'}
                    </div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-details">
                            ${product.sizes ? `Tallas: ${product.sizes}<br>` : ''}
                            ${product.colors ? `Colores: ${product.colors}<br>` : ''}
                            Entrega: ${product.deliveryTime || '3-5 dÃ­as'}
                        </div>
                        <div class="product-price">${product.price.toLocaleString('es-CO')}</div>
                        <button class="add-to-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Agregar al Carrito</button>
                    </div>
                </div>
            `).join('');
        }

        updateCart();
    </script>
</body>
</html>
