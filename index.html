<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Distrito 110</title>
  
  <!-- Estilos incrustados -->
  <style>
    :root {
      --rojo: #e63946;
      --verde: #2a9d8f;
      --gris: #f4f4f4;
    }
    body {
      margin:0; font-family:Arial, sans-serif; background:#fff; color:#333;
    }
    header {
      display:flex; justify-content:space-between; align-items:center;
      padding:1rem; background:var(--rojo); color:#fff;
    }
    h1 { margin:0; font-size:1.5rem; }
    .cart-icon { cursor:pointer; font-size:1.2rem; }
    .categories {
      display:flex; gap:0.5rem; padding:1rem; background:#f8f8f8;
    }
    .category-btn {
      padding:0.5rem 1rem; border:none; border-radius:5px;
      cursor:pointer; background:#ddd;
    }
    .category-btn.active { background:var(--rojo); color:#fff; }
    .products-grid {
      display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
      gap:1rem; padding:1rem;
    }
    .product-card {
      border:1px solid #ddd; border-radius:10px; overflow:hidden;
      background:#fff; cursor:pointer; transition:transform 0.2s;
    }
    .product-card:hover { transform:scale(1.02); }
    .product-image img { width:100%; height:200px; object-fit:cover; }
    .product-info { padding:1rem; }
    .product-name { font-weight:bold; margin-bottom:0.5rem; }
    .product-details { font-size:0.9rem; color:#555; margin-bottom:0.5rem; }
    .product-price { font-size:1.2rem; font-weight:bold; color:var(--rojo); }
    .add-to-cart {
      margin-top:0.5rem; padding:0.5rem 1rem; border:none;
      background:var(--verde); color:#fff; border-radius:5px; cursor:pointer;
    }
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6); justify-content:center; align-items:center;
    }
    .modal.active { display:flex; }
    .modal-content {
      background:#fff; padding:2rem; border-radius:10px; width:90%; max-width:600px;
      max-height:90%; overflow-y:auto;
    }
    .submit-btn { background:var(--rojo); color:#fff; padding:0.7rem 1rem; border:none; border-radius:5px; cursor:pointer; }
    .whatsapp-btn {
      position:fixed; bottom:20px; right:20px; background:#25d366; padding:15px;
      border-radius:50%; display:flex; align-items:center; justify-content:center;
      box-shadow:0 4px 6px rgba(0,0,0,0.2);
    }
    .whatsapp-btn svg { width:32px; height:32px; fill:#fff; }
  </style>
</head>
<body>

  <div id="loginScreen" class="login-screen">
    <form id="loginForm" onsubmit="login(event)">
      <h2>Iniciar Sesión</h2>
      <input type="email" id="loginEmail" placeholder="Correo" required>
      <input type="password" id="loginPassword" placeholder="Contraseña" required>
      <button type="submit" id="loginBtn">Iniciar Sesión</button>
      <div id="loginError" class="error-msg"></div>
    </form>
  </div>

  <div id="mainApp" class="hidden">
    <header>
      <h1>Distrito 110</h1>
      <div class="cart-icon" onclick="toggleCart()">
        🛒 <span id="cartCount">0</span>
      </div>
      <button id="logoutBtn" onclick="logout()" class="hidden">Cerrar Sesión</button>
    </header>

    <nav class="categories">
      <button class="category-btn active" onclick="filterCategory('todos')">Todos</button>
      <button class="category-btn" onclick="filterCategory('ropa')">Ropa</button>
      <button class="category-btn" onclick="filterCategory('calzado')">Calzado</button>
    </nav>

    <main>
      <div id="productsGrid" class="products-grid"></div>
    </main>
  </div>

  <div class="modal" id="cartModal">
    <div class="modal-content">
      <h2>Carrito</h2>
      <div id="cartItems"></div>
      <div class="cart-summary">
        <strong>Total:</strong> <span id="cartTotal">0</span>
      </div>
      <button id="showCheckoutBtn" onclick="showCheckoutForm()">Proceder al Pago</button>
      <form id="checkoutForm" style="display:none;">
        <input type="text" id="customerName" placeholder="Nombre" required>
        <input type="tel" id="customerPhone" placeholder="Teléfono" required>
        <input type="text" id="customerCity" placeholder="Ciudad" required>
        <input type="text" id="customerAddress" placeholder="Dirección" required>
        <div class="payment-methods">
          <div class="payment-method" onclick="selectPayment('Contraentrega')">Contraentrega</div>
          <div class="payment-method" onclick="selectPayment('Transferencia')">Transferencia</div>
        </div>
        <button type="button" id="checkoutBtn" onclick="processCheckout()" disabled>Finalizar Pedido</button>
      </form>
    </div>
  </div>

  <a href="https://wa.me/573189377107?text=Hola,%20necesito%20ayuda" class="whatsapp-btn" target="_blank">
    <svg viewBox="0 0 32 32">
      <path d="M16 0c-8.837 0-16 7.163-16 16..."/>
    </svg>
  </a>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, Timestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBCxsB21i2-g9c6zIY988R8Xvq5ctVLzrI",
      authDomain: "distrito110-f80c4.firebaseapp.com",
      projectId: "distrito110-f80c4",
      storageBucket: "distrito110-f80c4.firebasestorage.app",
      messagingSenderId: "433906086147",
      appId: "1:433906086147:web:b1595ae6759d2499073936"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let products = [];
    let cart = JSON.parse(localStorage.getItem('distrito110_cart')) || [];
    let currentFilter = 'todos';

    function login(event) { /* ... */ }
    function logout() { /* ... */ }
    function toggleCart() { /* ... */ }
    function showCheckoutForm() { /* ... */ }
    function selectPayment(method) { /* ... */ }
    function processCheckout() { /* ... */ }
    function updateCart() { /* ... */ }
    function filterCategory(category) { /* ... */ }
    function addToCart(id) { /* ... */ }

    function renderProducts(filter = 'todos') {
      currentFilter = filter;
      const grid = document.getElementById('productsGrid');
      if (products.length === 0) {
        grid.innerHTML = '<div class="empty-products">No hay productos disponibles</div>';
        return;
      }
      const filteredProducts = filter === 'todos' ? products : products.filter(p => p.category === filter);
      if (filteredProducts.length === 0) {
        grid.innerHTML = '<div class="empty-products">No hay productos en esta categoría</div>';
        return;
      }
      grid.innerHTML = filteredProducts.map(product => `
        <div class="product-card" onclick="openProductDetail('${product.id}')">
          <div class="product-image">
            ${product.image ? `<img src="${product.image}" alt="${product.name}">` : '<div style="font-size:4rem;">📦</div>'}
          </div>
          <div class="product-info">
            <div class="product-name">${product.name}</div>
            <div class="product-details">
              ${product.sizes ? `Tallas: ${product.sizes}<br>` : ''}
              ${product.colors ? `Colores: ${product.colors}<br>` : ''}
              Entrega: ${product.deliveryTime || '3-5 días'}
            </div>
            <div class="product-price">${product.price.toLocaleString('es-CO')}</div>
            <button class="add-to-cart" onclick="event.stopPropagation(); addToCart('${product.id}')">Agregar al Carrito</button>
          </div>
        </div>
      `).join('');
    }

    updateCart();
  </script>
</body>
</html>